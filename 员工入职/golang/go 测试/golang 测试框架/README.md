[TOC]

## golang 单元测试测试框架介绍

- ~~gostub 主要用来给变量、函数、过程打桩。但是给函数打桩时，需要做侵入式修改。~~

- goconvey 主要用途是用来更加方便简单写测试用例，提供了很多断言（不做重点介绍）。

- gomock 用来给**接口打桩**的。 要使用 mockgen 生成对应的接口测试文件。

- gomonkey 主要也是用来给**变量、函数、方法和接口**打桩。v2.3.0 之后已经支持 private 方法打桩（gomonkey 对接口打桩有一定的局限性，用起来也没有 gomock 好理解）。

- httptest, httpmock 用来对 http 请求进行测试（建议尽量 httptest，因为这毕竟是标准库里的包，而且功能也挺全了的）

## 注意

- gostub 因为给函数打桩时候需要修改原函数，但是正常情况下不建议使用，就不介绍了。
- gomonkey 打桩的原理则是在运行时通过汇编语句重写可执行文件，将待打桩函数或方法的实现跳转到桩实现，原理和热补丁类似。但是 gomoneky 不是线程安全的，**不能用在并发测试中**。
- 如果我们引用测试框架用的不是 go.mod，而是 vendor，那么执行测试用例的时候需要加上 `-mod=vendor`，如: `go test -mod=vendor .`

